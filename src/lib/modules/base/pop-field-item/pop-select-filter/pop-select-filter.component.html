<div class="pop-select-filter-container import-field-item-container" [ngClass]="{'pop-select-filter-single': !config.multiple, 'pop-select-filter-multiple':config.multiple}" (libClickOutside)="onOutsideCLick();" [style.marginBottom.px]="config.offset">
  <lib-pop-input
    class="pop-select-filter-values"
    *ngIf="ui.selected?.config"
    [class.filter-selected]="dom.state.filterActivated"
    [config]=ui.selected.config
    (click)="onToggleFilter($event, list);">
  </lib-pop-input>
  <lib-pop-field-item-loader [show]="config.patch.displayIndicator && config.patch.running"></lib-pop-field-item-loader>

  <!--<div [ngClass]="{'sw-hidden':!config.selectedOptions.length}" class="pop-select-filer-count">{{config.selectedOptions.length}}</div>-->

  <!--<mat-icon class="select-filter-button-icon sw-pointer" (click)="onToggleFilter($event, list);">arrow_drop_down</mat-icon>-->

  <!--<div class="pop-select-filter-feedback">-->
    <!--<div *ngIf="config.message"-->
         <!--class="pop-select-error"-->
         <!--matTooltipPosition="left"-->
         <!--[matTooltip]=config.message>-->
      <!--<mat-icon color="warn">info</mat-icon>-->
    <!--</div>-->
  <!--</div>-->

  <div class="select-filter-content select-filter-items-{{config.position}}" [ngClass]="{'sw-hidden': !dom.state.filterActivated}" #list>

    <div class="pop-select-search-header">
      <mat-checkbox
        *ngIf="config.multiple"
        [(ngModel)]="config.all"
        [color]="'primary'"
        matTooltip="Toggle All"
        matTooltipPosition="above"
        (change)="onAllChange($event.checked);">
      </mat-checkbox>

      <mat-form-field *ngIf="config.filter && ui.search.config" appearance="none" floatLabel="never" class="sw-search">
        <a matPrefix>
          <mat-icon>search</mat-icon>
        </a>
        <input matInput placeholder="Search"
               class="sw-pointer"
               #search
               type="text"
               [formControl]="ui.search.config.control">
        <mat-icon class="sw-cursor-pointer sw-pointer" matSuffix (click)="ui.search.config.control.setValue('');">close</mat-icon>
      </mat-form-field>

    </div>

    <mat-selection-list [style.minHeight.px]=config.minHeight [style.maxHeight.px]=config.height #selectionList>
      <div *ngFor="let group of config.groups">
        <div class="pop-select-option-header" *ngIf="group.label && group.visible">
          <mat-checkbox
            *ngIf="config.multiple"
            [(ngModel)]="group.all"
            [color]="'primary'"
            [indeterminate]=group.indeterminate
            matTooltip="Toggle Group"
            matTooltipPosition="above"
            (change)="onGroupChange($event.checked, group);">
          </mat-checkbox>
          <div class="pop-select-header-label" (click)="onToggleGroup(group);">{{group.label}} ({{group.options.values.length}})</div>

        </div>
        <mat-list-option
          [checkboxPosition]=dom.state.checkboxPosition
          class="pop-select-filter-option"
          *ngFor="let option of group.options.values"
          [ngClass]="{'sw-hidden': option.hidden || !group.open, 'pop-select-filter-active': dom.active.optionId && option.value === dom.active.optionId}"
          [style.paddingLeft]="option.level+'px'"
          [selected]=isOptionSelected(option)
          (click)="onOptionChange($event, option, group);"
          [value]="option.value">
          {{option.name}}
        </mat-list-option>
      </div>
      <lib-pop-field-item-loader [show]="config.patch.displayIndicator && config.patch.running"></lib-pop-field-item-loader>
    </mat-selection-list>
  </div>
</div>
