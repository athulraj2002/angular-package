<div class="access-permissions-container">
  <div class="sw-label-container">
    Access Permissions
    <mat-form-field class="access-expansion-state-select" appearance="outline">
      <mat-label>Expand</mat-label>
      <mat-select [(ngModel)]="dom.state.expansion" (selectionChange)="setExpansionState();">
        <mat-option value="none">None</mat-option>
        <mat-option value="compact">Compact</mat-option>
        <mat-option value="full">Full</mat-option>
      </mat-select>
    </mat-form-field>
    <!--<mat-icon class="admin-icon-top-right"-->
    <!--[ngClass]="{'sw-hidden': state.expansion === 'full'}"-->
    <!--matTooltip="Expand"-->
    <!--matTooltipPosition="left"-->
    <!--(click)="setExpansionState('full');">expand_more</mat-icon>-->
    <!--<mat-icon class="admin-icon-top-right"-->
    <!--[ngClass]="{'sw-hidden': state.expansion === 'compact'}"-->
    <!--matTooltip="Compact"-->
    <!--matTooltipPosition="left"-->
    <!--(click)="setExpansionState('compact');">expand_less</mat-icon>-->
  </div>
  <mat-divider></mat-divider>
  <div class="access-filter-bar-loader">
    <mat-progress-bar *ngIf="dom.state.loading" mode="indeterminate"></mat-progress-bar>
  </div>
  <div class="access-permissions-content">
    <mat-accordion *ngIf="ui.access" multi="true" [displayMode]="'flat'">
      <mat-expansion-panel *ngFor="let app of ui.access" [ngClass]="{'sw-hidden':!app.entities.length}"
                           [expanded]="app.expanded" hideToggle="true">
        <mat-expansion-panel-header>
          <div class="access-app-permission-header pt-bg-1" (click)="$event.stopPropagation();">
            <div class="access-app-title-container mat-h2">
              <div class="access-app-title">{{app.name}}</div>
              <div class="access-app-toggle-container">
                <mat-icon *ngIf="!app.expanded" (click)="toggleApp(app);">keyboard_arrow_right
                </mat-icon>
                <mat-icon *ngIf="app.expanded" (click)="toggleApp(app);">keyboard_arrow_down
                </mat-icon>
              </div>
            </div>
            <div class="access-spacer"></div>
            <div class="access-app-permission-container">
              <mat-checkbox [(ngModel)]="app.can_read.all"
                            [indeterminate]="app.can_read.indeterminate"
                            (change)="checkAll(app, 'can_read');" [disabled]="app.can_read.disabled">
                View
              </mat-checkbox>
            </div>
            <div class="access-app-permission-container">
              <mat-checkbox [(ngModel)]="app.can_create.all"
                            [indeterminate]="app.can_create.indeterminate"
                            (change)="checkAll(app, 'can_create');"
                            [disabled]="app.can_create.disabled">Create
              </mat-checkbox>
            </div>
            <div class="access-app-permission-container">
              <mat-checkbox [(ngModel)]="app.can_update.all"
                            [indeterminate]="app.can_update.indeterminate"
                            (change)="checkAll(app, 'can_update');"
                            [disabled]="app.can_update.disabled">Edit
              </mat-checkbox>
            </div>
            <div class="access-app-permission-container">
              <mat-checkbox [(ngModel)]="app.can_delete.all"
                            [indeterminate]="app.can_delete.indeterminate"
                            (change)="checkAll(app, 'can_delete');"
                            [disabled]="app.can_delete.disabled">Delete
              </mat-checkbox>
            </div>
          </div>
        </mat-expansion-panel-header>
        <div class="mat-expansion-panel-body">
          <div class="access-app-entity-header" *ngFor="let entity of app.entities">
            <div class="access-entity-title-container mat-h2">
              <div class="access-entity-title">{{entity.name}}</div>
            </div>
            <div class="access-spacer"></div>
            <div class="access-app-permission-container">
              <lib-pop-checkbox [config]="entity.field.can_read"
                                (events)="handleInputEvents($event)"></lib-pop-checkbox>
            </div>
            <div class="access-app-permission-container">
              <lib-pop-checkbox [config]="entity.field.can_create"
                                (events)="handleInputEvents($event)"></lib-pop-checkbox>
            </div>
            <div class="access-app-permission-container">
              <lib-pop-checkbox [config]="entity.field.can_update"
                                (events)="handleInputEvents($event)"></lib-pop-checkbox>
            </div>
            <div class="access-app-permission-container">
              <lib-pop-checkbox [config]="entity.field.can_delete"
                                (events)="handleInputEvents($event)"></lib-pop-checkbox>
            </div>
          </div>
        </div>
      </mat-expansion-panel>
    </mat-accordion>
  </div>
</div>
