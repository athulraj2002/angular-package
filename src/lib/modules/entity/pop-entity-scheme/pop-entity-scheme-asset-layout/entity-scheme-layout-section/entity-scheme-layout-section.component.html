<div class="entity-scheme-asset-layout-section" *ngIf="dom.state.loaded">
  <mat-accordion
    class="entity-scheme-asset-list"
    multi="true"
    [displayMode]="'flat'"
    [style.height.px]=dom.height.outer>
    <div class="entity-scheme-asset-layout-section-header">
      <!--<div>{{section.name}}</div>-->
      <lib-pop-input [config]="ui.header"></lib-pop-input>
    </div>
    <div class="entity-scheme-asset-list-content"
         cdkDropList
         id="column-{{section.position}}"
         [attr.data-position]=section.position
         [attr.data-start-index]=section.startIndex
         [attr.data-id]=section.id
         [cdkDropListData]="section.children"
         (cdkDropListDropped)="onAssetSortDrop($event)"
         [cdkDropListEnterPredicate]="section.predicate"
         [style.height.px]=dom.height.inner>
      <div class="sw-mar-vrt-xs sw-clear"></div>
      <div *ngFor="let child of section.children">

        <div class="entity-scheme-asset" *ngIf="child.container">
          Container
        </div>

        <div class="entity-scheme-asset" *ngIf="!child.container"
             [ngClass]="{'entity-scheme-asset-field-container': true, 'sw-disabled': child.asset_type === 'table'}"
             (mouseenter)="onShowAssetMenu(child)"
             (mouseleave)="onHideAssetMenu(child)"
             cdkDrag
             (cdkDragDrop)="onAssetSortDrop($event)"
             [cdkDragData]="{id: child.id, asset_id: child.asset_id,asset_type: child.asset_type, position: section.position, compact: child.compact}"
             cdkDragBoundary=".entity-scheme-asset-layout-container">
          <div class="import-flex-row">
            <div class="import-flex-column-break import-flex-column import-flex-start-center" [style.maxWidth.px]="12">
              <i *ngIf="child.asset.required" class="sw-pointer entity-scheme-required" [matTooltip]="'required'">
                *
              </i>
            </div>
            <div class="import-flex-column-break import-flex-column">
              <div class="entity-scheme-asset-layout-row">
                <div class="entity-scheme-asset-handle" [ngClass]="{'entity-scheme-asset-handle-disabled': child.asset_type === 'table'}" cdkDragHandle>
                  <!--<div>-->
                    {{child.name}}
                  <!--</div>-->
                </div>
                <div class="entity-scheme-asset-menu" *ngIf="!child.menu" [@fadeInOut]="'in'">
                  <div class="entity-scheme-asset-menu-icon" *ngIf="child.asset.primary">
                    <i class="material-icons sw-pointer entity-scheme-primary" [matTooltip]="'Primary'">
                      star
                    </i>
                  </div>
                </div>
                <!--<div class="entity-scheme-asset-trait-container">-->
                  <!--<mat-icon class="entity-scheme-asset-trait-icon sw-pointer" *ngFor="let trait of entry.traits" matTooltip="{{trait.label}}" matTooltipPosition="above">{{trait.icon}}</mat-icon>-->
                <!--</div>-->
                <div class="entity-scheme-asset-menu" *ngIf="child.menu" [@fadeInOut]="'in'">
                  <div class="entity-scheme-asset-menu-icon">
                    <i class="material-icons sw-pointer"
                       (click)="onEditAsset(child)">
                      edit
                    </i>
                  </div>
                  <div class="entity-scheme-asset-menu-icon" *ngIf="!child.asset.primary">
                    <i class="material-icons sw-pointer"
                       (click)="onRemoveChildFromLayout(section.position, child)">
                      clear
                    </i>
                  </div>

                </div>
              </div>
              <div class="entity-scheme-asset-layout-subrow" [ngSwitch]="child.asset_type">
                <div *ngSwitchCase="'table'">Default Column</div>
                <div *ngSwitchCase="'field'">{{child.asset?.fieldgroup?.label}} Field</div>
                <div *ngSwitchCase="'component'">Component</div>
              </div>
            </div>

          </div>
          <div class="entity-scheme-asset-layout-content-row" *ngIf="dom.session.expanded[child.id]" [ngClass]="{'entity-scheme-asset-layout-row-expanded': dom.session.expanded[child.id]}" [ngSwitch]="child.asset_type">
            <lib-entity-scheme-table-content *ngSwitchCase="'table'" [core]="core" [config]="child"></lib-entity-scheme-table-content>
            <lib-entity-scheme-field-content *ngSwitchCase="'field'" [core]="core" [config]="child"></lib-entity-scheme-field-content>
            <lib-entity-scheme-component-content *ngSwitchCase="'component'" [core]="core" [config]="child"></lib-entity-scheme-component-content>
          </div>
          <div class="entity-scheme-asset-toggle-row sw-pointer" *ngIf="child.id && child.asset && child.asset.multiple && child.asset.entries && child.asset.entries.length > 1" (click)="onExpandAssetContent(child)">
            <div class="material-icons sw-pointer" [ngClass]="{'sw-hidden': dom.session.expanded[child.id]}">
              expand_more
            </div>
            <div class="material-icons sw-pointer" [ngClass]="{'sw-hidden': !dom.session.expanded[child.id]}">
              expand_less
            </div>
          </div>

        </div>

      </div>

    </div>
  </mat-accordion>
</div>
