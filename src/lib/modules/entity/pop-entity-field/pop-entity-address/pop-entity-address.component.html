<div class="pop-entity-address-field import-field-container">

  <!--<div class="pop-entity-address-readonly-container" [ngClass]="{'sw-hidden': dom.state.template !== 'template_readonly'}">-->
  <div class="pop-entity-address-readonly-container">
    <div class="pop-entity-address-label-header">
      <div class="pop-entity-address-label pop-entity-address-label-title" *ngIf="field.multiple">
        &nbsp;Label
      </div>
      <div class="pop-entity-address-label pop-entity-address-label-address">
        &nbsp;<div *ngIf="field.multiple">Address</div>
        <div *ngIf="!field.multiple">{{field.entries[0].name}}</div>
      </div>

      <div class="pop-entity-address-label pop-entity-address-label-icon">
        <div class="import-flex-row import-flex-item-sm import-flex-grow-sm"></div><!-- Filler -->
        <lib-pop-entity-field-edit-icon
          *ngIf="!field.multiple"
          class="import-flex-align-end"
          (events)="onActionEvent($event, 0);" [field]="field"
          [dom]="dom"
        ></lib-pop-entity-field-edit-icon>
      </div>

    </div>

    <div [ngClass]="{'sw-field-mar-btm-sm':isLast}" *ngFor="let dataKey of field.data_keys; last as isLast;">
      <div *ngIf="field.data[dataKey]; let data;">
        <div *ngIf="field.items[dataKey].config; let items;">
          <div *ngIf="dom.state[dataKey]; let state;">
            <div *ngIf="dom.session[dataKey].display; let display;">

              <div class="pop-entity-address-item-header" [ngClass]="{'sw-hidden':state.open}">
                <div class="pop-entity-address-item  pop-entity-address-item-title" *ngIf="field.multiple">
                  <div>{{dom.session[ dataKey ].display.label}}</div>
                </div>
                <div class="pop-entity-address-item  pop-entity-address-item-address">
                  <div class="import-flex-row-wrap" *ngIf="items['line_1'] && data['line_1']">
                    <div>&nbsp;{{data['line_1']}}</div>
                  </div>

                  <div class="import-flex-row-wrap">
                    <div *ngIf="items['line_2'] && data['line_2']">&nbsp;{{data['line_2']}}</div>
                    <div *ngIf="items['line_3'] && data['line_3']">&nbsp;{{data['line_3']}}</div>
                  </div>

                  <div class="import-flex-row-wrap">
                    <div *ngIf="items['city'] && data['city']">&nbsp;{{data['city']}}</div>
                    <div *ngIf="items['city'] && data['city'] && items['region_id'] && display['region_id']">,</div>
                    <div *ngIf="items['region_id'] && display['region_id']">
                      &nbsp;{{display['region_id']}}</div>
                    <div *ngIf="items['region_id'] && data['region_id'] && items['county'] && data['county']">
                      ,</div>
                    <div *ngIf="items['county'] && data['county']">&nbsp;{{data['county']}}</div>
                    <div *ngIf="items['zip'] && data['zip']">&nbsp;{{data['zip']}}</div>
                    <div *ngIf="items['zip_4'] && data['zip_4']">-{{data['zip_4']}}</div>
                    <div *ngIf="items['country_id'] && display['country_id']">&nbsp;{{display['country_id']}}</div>
                  </div>

                </div>
                <div class="pop-entity-address-item-icon">
                  <!-- Filler -->
                  <lib-pop-entity-field-edit-icon
                    *ngIf="field.multiple"
                    [style.marginLeft.px]="-15"
                    (events)="onActionEvent($event, dataKey);" [field]="field"
                    [dom]="dom"
                  ></lib-pop-entity-field-edit-icon>
                </div>
              </div>
              <mat-divider *ngIf="!isLast" [style.width.%]="100" [style.marginTop.px]="5"></mat-divider>

              <div [ngClass]="{'sw-hidden':!state.open}" class="pt-02 sw-pad-hrz-sm sw-mar-top-xs">
                <div class="import-flex-row import-field-flex-row-offset">
                  <div class="import-flex-row-wrap">

                    <!-- v Label and Custom lablel - turned off for now v -->

                    <!--<div *ngIf="field.multiple && field.setting.edit_label && asset.entry; let entry;" class="import-field import-field-spacing import-flex-item-sm import-flex-grow-sm">-->
                    <!--<lib-pop-select [config]="entry"></lib-pop-select>-->
                    <!--</div>-->
                    <!--<div *ngIf="state.customLabel && asset.customLabel; let item;" class="import-field import-field-spacing import-flex-item-sm import-flex-grow-sm">-->
                    <!--<lib-pop-input [config]="item"></lib-pop-input>-->
                    <!--</div>-->
                    <!--<div class="import-flex-row-break"></div>-->

                    <!-- ^ Label and Custom lable - turned off for now ^ -->


                    <div *ngIf="items['line_1']" class="import-field import-field-spacing import-flex-item-full import-flex-grow-lg">
                      <lib-pop-input
                        [config]="items['line_1']"
                        (events)="onFieldItemEvent($event, dataKey, 'line_1');"
                      ></lib-pop-input>
                    </div>

                    <div *ngIf="items['line_2']" class="import-field import-field-spacing import-flex-item-sm import-flex-grow-sm">
                      <lib-pop-input
                        [config]="items['line_2']"
                        (events)="onFieldItemEvent($event, dataKey, 'line_2');"
                      ></lib-pop-input>
                    </div>

                    <div *ngIf="items['line_3']" class="import-field import-field-spacing import-flex-item-sm import-flex-grow-sm">
                      <lib-pop-input
                        [config]="items['line_3']"
                        (events)="onFieldItemEvent($event, dataKey, 'line_3');"
                      ></lib-pop-input>
                    </div>

                    <div class="import-flex-row-break"></div>
                    <div *ngIf="items['zip']" class="import-flex-row import-field-spacing import-flex-item-xs import-flex-grow-xs">
                      <lib-pop-input class="import-flex-item-xs import-flex-grow-xs" [config]="items['zip']" (events)="onFieldItemEvent($event, dataKey, 'zip');"></lib-pop-input>
                    </div>

                    <div *ngIf="items['zip_4']" class="import-flex-row import-field-spacing import-flex-item-xs import-flex-grow-xs">
                      <lib-pop-input class="import-flex-item-xs import-flex-grow-xs" [config]="items['zip_4']" (events)="onFieldItemEvent($event, dataKey, 'zip_4');"></lib-pop-input>
                    </div>
                    <!-- Show error message -->

                    <div *ngIf="items['zip']" class="import-flex-row-break"></div>

                    <mat-progress-bar
                    class="pop-field-item-loader"
                    *ngIf="state.loading"
                    [style.height.px]="1"
                    [mode]="'query'"
                  >
                  </mat-progress-bar>

                    <div *ngIf="items['zip'] && state.zipError" class="import-flex-row import-field-spacing import-flex-item-xs import-flex-grow-xs">

                      <p >{{state.zipError}}</p>
                    </div>
                    <div class="import-flex-row-break"></div>



                    <div *ngIf="items['city']" class="import-field import-field-spacing import-flex-item-xs import-flex-grow-xs">
                      <lib-pop-input [config]="items['city']" (events)="onFieldItemEvent($event, dataKey, 'city');"></lib-pop-input>
                    </div>

                    <div *ngIf="items['region_id']" class="import-field import-field-spacing import-flex-item-xs import-flex-grow-xs">
                      <lib-pop-select [config]="items['region_id']" (events)="onFieldItemEvent($event, dataKey, 'region_id');"></lib-pop-select>
                    </div>


                    <div class="import-flex-row-break"></div>

                    <div *ngIf="items['county']"
                         class="import-field import-field-spacing import-flex-item-xs import-flex-grow-xs">
                      <lib-pop-input [config]="items['county']"
                                     (events)="onFieldItemEvent($event,dataKey,  'county');"></lib-pop-input>
                    </div>

                    <div *ngIf="items['country_id']"
                         class="import-field import-field-spacing import-flex-item-xs import-flex-grow-xs">
                      <lib-pop-select [config]="items['country_id']"
                                      (events)="onFieldItemEvent($event, dataKey, 'country_id');"></lib-pop-select>
                    </div>
                  </div>
                </div>

                <div class="import-field-footer sw-mar-top-sm sw-pad-rgt-lg" *ngIf="field.canRemove">
                  <lib-pop-field-btn class="sw-mar-rgt-sm" action="remove" [field]="field" (events)="onActionEvent($event, dataKey);"></lib-pop-field-btn>
                </div>

                <div *ngIf="true" class="import-flex-row-wrap import-flex-end sw-pad-rgt-lg sw-pad-vrt-lg">
                  <lib-pop-button
                    [config]="{value:'Close', size: 30, color: 'accent', bubble: true, event: 'close'}"
                    (events)="onActionEvent($event, dataKey);"
                  ></lib-pop-button>
                </div>
                <div *ngIf="false" class="import-flex-row-wrap import-flex-end sw-pad-rgt-lg sw-pad-vrt-lg">
                  <lib-pop-button
                    [config]="{value:'Close', size: 30, color: 'accent', bubble: true, event: 'close'}"
                    (events)="onActionEvent($event);"
                  ></lib-pop-button>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

