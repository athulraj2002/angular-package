<div class="mm-sticky-container" (window:resize)="onUpdateMenus()">
  <!-- User Not Logged In -->
  <div *ngIf="!dom.state.authenticated" class="mm-container pt-bg-1">
    <div class="mm-bu">
      <div class="mm-bu-selected">
        <a href="/public/" onclick="window.location.reload()">PopCX</a>
      </div>
    </div>

    <div class="mm-public">
      <div class="mm-buttons">
        <button mat-raised-button (click)="onChangeApp('/login')" role="button">Login</button>
      </div>
      <div class="mm-buttons">
        <button mat-raised-button (click)="onChangeApp('/signup')" role="button">Sign Up</button>
      </div>
    </div>

  </div>

  <!-- User Logged In -->
  <div class="mm-container pt-bg-1" [ngClass]="{'sw-hidden': !dom.state.authenticated}">

    <div *ngIf="!dom.active.business" class="mm-bu">
      <div class="mm-bu-selected">
        <a onclick="window.location.reload()">Welcome to PopCX</a>
      </div>
    </div>

    <div *ngIf="dom.active.business" class="mm-bu active-business" >
      <div *ngIf="ui.alternate_businesses.length" [matMenuTriggerFor]="businessUnitMenu" class="mm-bu-more" >
        <img *ngIf="dom.active.business.logo_main_url" class="mm-bu-selected-img" src="{{dom.active.business.logo_main_url}}">
        <span *ngIf="!dom.active.business.logo_main_url" class="mm-bu-selected">{{dom.active.business.name}}</span>
        <mat-menu #businessUnitMenu="matMenu" [overlapTrigger]="false" class="mm-bu-list">
          <div *ngFor="let business of ui.alternate_businesses" (click)="onChangeBusiness(business.id)">
            <img *ngIf="business.logo_main_url" class="mm-nav-item-img" src="{{business.logo_main_url}}">
            <span *ngIf="!business.logo_main_url" class="mm-bu-list-item">{{business.name}}</span>
          </div>
        </mat-menu>
      </div>
      <div *ngIf="!ui.alternate_businesses.length">
        <img *ngIf="dom.active.business.logo_main_url" class="mm-bu-selected-img" src="{{dom.active.business.logo_main_url}}">
        <span *ngIf="!dom.active.business.logo_main_url" class="mm-bu-selected">{{dom.active.business.name}}</span>
      </div>
    </div>



    <div class="mm-nav" #mmNavRef>
      <div *ngFor="let menu of ui.menus.all" class="mm-nav-item-hidden">
        <!-- Fake Div is here to stablize the nav buttons so they do not expand in size when hover trasition is applied-     -->
        <div class="mm-nav-item-fake"><span>{{menu.name}}</span></div>
        <div class="mm-nav-item mat-h4" [ngClass]="{'mm-nav-item-active' : menu.path == dom.active.path}" (click)="onChangeApp(menu.path)">
          <span >{{menu.name}}</span>
        </div>
      </div>
    </div>

    <div class="mm-misc" >
      <div *ngIf="ui.menus.more.length">
        <div class="mm-misc-more" [matMenuTriggerFor]="moreMenus">
          <mat-icon>more_vert</mat-icon>
        </div>
        <mat-menu #moreMenus="matMenu" [overlapTrigger]="false" class="">
          <div *ngFor="let menu of ui.menus.more" class="" (click)="onChangeApp(menu.path)">
            <span class="mm-more-menu-item">{{menu.name}}</span>
          </div>
        </mat-menu>
      </div>


      <div class="search-control mm-misc">
        <div >
          <mat-form-field class="sw-search" appearance="outline" >
            <span matPrefix class="search-icon">
              <mat-icon>search</mat-icon>
            </span>
            <input  matInput placeholder="Search">
          </mat-form-field>
        </div>
      </div>

      <mat-icon class="mm-misc-notification">notifications</mat-icon>
    </div>

    <div class="mm-profile" [matMenuTriggerFor]="profileMenu" >

      <div class="mm-profile-avatar" *ngIf="ui.user">
        <img *ngIf="ui.user.avatarLink" class="mm-avatar-img" [src]="ui.user.avatarLink"/>
        <div *ngIf="!ui.user.avatarLink" class="sw-circle-ID">
          {{ui.user.initials}}
        </div>
      </div>

      <mat-menu #profileMenu="matMenu" [overlapTrigger]="false" class="mm-profile-menu">
        <!--<div *ngIf="dom.state.isDevMode" class="mm-profile-list-item" (click)="onAuthVerification();">Verify Auth (Temp)</div>-->
        <div class="mm-profile-list-item" (click)="onChangeApp('/user/profile');">Profile</div>
        <div class="mm-profile-list-item" (click)="onChangeApp('/logout');">Logout</div>
      </mat-menu>
    </div>

  </div>
</div>
